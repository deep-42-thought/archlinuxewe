# Maintainer: Erich Eckner <arch at eckner dot net>

pkgname='local-certificates'
arch=('any')
pkgver=2020.05.31.20.11.09
pkgrel=1
pkgdesc='Certificate for local version of https://arch.eckner.net'
license=('GPL')
install='local-certificates.install'
url='https://eckner.net/certs'

source=(
  'https://eckner.net/certs/2020-05-26T14:30:26.opennic_root_ca.crt'
  'https://eckner.net/certs/2020-01-14T09:40:53.root-ca.old.crt'
  'https://eckner.net/certs/2020-05-31T20:11:09.root-ca.crt'
)
sha512sums=(
  '52b9725e7e5efe5b0354bf28ba5069d37bf1ad6d71ffbb1e4de48d31409f6f7e0033b60797d3c2e5972ca91f14513f3b81f429e0f6147a962534868131f763b9'
  'ba8266c9f7eb54d27a18b599e3ce2e01053e9b161343916fb6bf6a27c42c522e4ba93bb02ccbea4da2a614495927acc75796d5bb1141af8eeaaab605b7abc085'
  '520a9b2912af8afd41e94420385765a09e692a448994059e32ce74c8ff4e4c0041b71f2f3d98f0bd7e4c64f8d156af3d903795cdcf7da763b8866ea9aceb350c'
)

package() {
  cd "${srcdir}"
  install -d "${pkgdir}/usr/share/ca-certificates/trust-source/anchors"
  for s in *{,.old}.cert.pem *{,.old}.crt; do
    [ -f "$s" ] || continue
    install \
      "${s}" \
      "${pkgdir}/usr/share/ca-certificates/trust-source/anchors/${s#????-??-??T??:??:??.}"
  done
}
