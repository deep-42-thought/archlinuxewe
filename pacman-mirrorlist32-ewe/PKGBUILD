# $Id$
# Contributor: Dan McGee <dan@archlinux.org>
# Maintainer: Erich Eckner <arch at eckner dot net>

pkgname=pacman-mirrorlist32-ewe
pkgver=20200306
provides=("pacman-mirrorlist32=${pkgver}")
conflicts=('pacman-mirrorlist32')
pkgrel=1
pkgdesc="Arch Linux 32 mirror list for use by pacman - ewe's favourites"
arch=('any')
url="https://www.archlinux.org/mirrorlist/"
license=('GPL')
backup=(etc/pacman.d/mirrorlist32)
source=("https://arch.eckner.net/merged/releng/os/x86_64/${pkgname%-ewe}-${pkgver}-${pkgrel%%.*}-any.pkg.tar.zst")
sha512sums=('73f3443ed26bedce503e10c67b3011b2d4bc021f7b97e2f7c4ceb66c4ee59f8f544302a23d3df0314c297696afb884b21eb04a9d6be44d7b6af5f492e2d40995')

build() {
  sed -i '
    0,/^$/ {
      /^$/ i Server = https://arch.eckner.net/merged/$repo/os/$arch
    }
  ' 'etc/pacman.d/mirrorlist32'
}

package() {
  mkdir -p "$pkgdir/etc/pacman.d"
  install -m644 'etc/pacman.d/mirrorlist32' "$pkgdir/etc/pacman.d/"
}
