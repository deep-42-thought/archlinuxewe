# $Id$
# Contributor: Dan McGee <dan@archlinux.org>
# Maintainer: Erich Eckner <arch at eckner dot net>

pkgname=pacman-mirrorlist
pkgver=20180224
pkgrel=1
pkgdesc="Arch Linux mirror list for use by pacman"
arch=('any')
url="https://www.archlinux.org/mirrorlist/"
license=('GPL')
backup=(etc/pacman.d/mirrorlist)
source=("${pkgname}-${pkgver}-${pkgrel%%.*}-any-original.tar.xz::https://arch.eckner.net/merged/core/os/$(uname -m)/${pkgname}-${pkgver}-${pkgrel%%.*}-any.pkg.tar.xz")
sha512sums=('60d1e2402b265beed4d0e4b01142a832a97c491b64e33956140586d7c9377e140f92977f4c99bff799cce0352152e6f2abd7a1f3c9dd087104a8a23007786c1a')

build() {
  {
    while read s
    do
      echo "${s}"
      if [ -z "${s}" ]
      then
        echo 'Server = https://arch.eckner.net/merged/$repo/os/$arch'
        echo ''
        break
      fi
    done
    cat
  } \
    < etc/pacman.d/mirrorlist \
    > mirrorlist
}

package() {
  mkdir -p $pkgdir/etc/pacman.d
  install -m644 mirrorlist $pkgdir/etc/pacman.d/
}
