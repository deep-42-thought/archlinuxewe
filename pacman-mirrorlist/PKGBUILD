# $Id$
# Contributor: Dan McGee <dan@archlinux.org>
# Maintainer: Erich Eckner <arch at eckner dot net>

pkgname=pacman-mirrorlist
pkgver=20160421
pkgrel=1
pkgdesc="Arch Linux mirror list for use by pacman"
arch=('any')
url="https://www.archlinux.org/mirrorlist/"
license=('GPL')
backup=(etc/pacman.d/mirrorlist)
source=("${pkgname}-${pkgver}-${pkgrel}-any-original.tar.xz::https://arch.eckner.net/core/os/$(uname -m)/${pkgname}-${pkgver}-${pkgrel}-any.pkg.tar.xz")

package() {
  mkdir -p $pkgdir/etc/pacman.d
  tar -xJf ${pkgname}-${pkgver}-${pkgrel}-any-original.tar.xz
  cat etc/pacman.d/mirrorlist | \
    (
      while read s
      do
        echo "${s}"
        if [ -z "${s}" ]
        then
          echo 'Server = https://arch.eckner.net/$repo/os/$arch'
          echo ''
          break
        fi
      done
      cat
    ) \
    > mirrorlist
  install -m644 mirrorlist $pkgdir/etc/pacman.d/
}

sha512sums=('b3d533090e771e0b8f254a2e746822d9810e493c429e4f221e21a23d86fefd9e38e4d9b6490ccf96784d24cd4485765361e0a39a5807632976f8fa6d7d969ca0')
